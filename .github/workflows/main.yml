name: Testing SSH from GitHub to Remote Host

on: [push]

jobs:
  check-remote-access:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Setup SSH key 🔐
        run: |
          mkdir -p ~/.ssh
          echo "${{ secrets.REMOTE_PUBLIC_KEY }}" > ~/.ssh/id_rsa
          chmod 600 ~/.ssh/id_rsa

      - name: Test SSH connection ✅
        run: |
          ssh -o StrictHostKeyChecking=no \
            -i ~/.ssh/id_rsa \
            -p ${{ secrets.REMOTE_HOST_SSH_PORT }} \
            ${{ secrets.REMOTE_HOST_SSH_USER }}@${{ secrets.REMOTE_HOST_IPV4 }} \
            "echo ✅ Conectado com sucesso ao servidor! >> github-action-is-here.txt"
